!function(t){var e=t('<div class="stb-select-container" tabindex="0"><span class="selected"></span></div>'),n=t('<ul class="stb-select" style="display:none;"></ul>');t.fn.stbDropdown=function(i){var a=t(this);a.hide(),a.each(function(i,a){var o=e.clone(),s=n.clone(),l=t(a),r=l.find("option");l.after(o),l.appendTo(o),s.appendTo(o),r.each(function(e,n){var i=t(n),a=t("<li></li>"),o=i.prop("attributes");a.prop("attributes",o),t.each(o,function(t,e){a.attr(e.name,e.value)});var l=i.find(">");a.append(l.length?l:i.text()),s.append(a)});l.children("option").filter(function(e,n){return t(n).is("[selected]")});o.on("click.stb.select",function(){var e=t(this),n=t.grep(t(".stb-select-container"),function(n){return!e.is(t(n))});t(n).find("ul").hide(),e.find("ul").toggle()}),o.on("click.stb.option","li",function(e){e.stopPropagation();var n=t(this),i=n.parents(".stb-select-container");i.find("span.selected").html(n.html()),n.parents("ul").toggle(),i.find("select").val(n.attr("value")).change(),n.siblings().removeAttr("selected"),n.attr("selected","selected")}),l.on("DOMNodeInserted",function(e){var n=t(e.target);if(n.is("option")){var i=t("<li></li>"),a=n.prop("attributes");i.prop("attributes",a),t.each(a,function(t,e){i.attr(e.name,e.value)});var o=n.find(">");i.append(o.length?o:n.text()),s.append(i)}}),l.on("DOMNodeRemoved",function(e){var n=t(e.target);n.is("option")&&s.find("li:contains('"+n.text()+"')").remove()})})}}(jQuery);